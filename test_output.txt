test_001_landing_page_accessible (__main__.TestViralLensSystem.test_001_landing_page_accessible)
Test: Landing page loads successfully ... ok
test_002_signup_with_valid_data (__main__.TestViralLensSystem.test_002_signup_with_valid_data)
Test: User can sign up with valid credentials ... ok
test_003_signup_with_duplicate_email (__main__.TestViralLensSystem.test_003_signup_with_duplicate_email)
Test: Cannot sign up with duplicate email ... FAIL
test_004_login_with_valid_credentials (__main__.TestViralLensSystem.test_004_login_with_valid_credentials)
Test: User can login with correct credentials ... ok
test_005_login_with_invalid_credentials (__main__.TestViralLensSystem.test_005_login_with_invalid_credentials)
Test: Cannot login with wrong password ... ok
test_006_protected_routes_require_login (__main__.TestViralLensSystem.test_006_protected_routes_require_login)
Test: Dashboard requires authentication ... ok
test_007_logout_functionality (__main__.TestViralLensSystem.test_007_logout_functionality)
Test: User can logout successfully ... ok
test_101_add_keyword (__main__.TestViralLensSystem.test_101_add_keyword)
Test: Can add keyword via API ... ok
test_102_get_keywords (__main__.TestViralLensSystem.test_102_get_keywords)
Test: Can retrieve keywords for logged-in user ... ok
test_103_edit_keyword (__main__.TestViralLensSystem.test_103_edit_keyword)
Test: Can edit existing keyword ... ok
test_104_toggle_keyword (__main__.TestViralLensSystem.test_104_toggle_keyword)
Test: Can toggle keyword enable/disable ... ok
test_105_delete_keyword (__main__.TestViralLensSystem.test_105_delete_keyword)
Test: Can delete keyword ... ok
test_106_keyword_category_field (__main__.TestViralLensSystem.test_106_keyword_category_field)
Test: Keyword category field is saved correctly ... ok
test_201_add_competitor (__main__.TestViralLensSystem.test_201_add_competitor)
Test: Can add competitor via API ... ok
test_202_get_competitors (__main__.TestViralLensSystem.test_202_get_competitors)
Test: Can retrieve competitors for logged-in user ... ok
test_203_toggle_competitor (__main__.TestViralLensSystem.test_203_toggle_competitor)
Test: Can toggle competitor enable/disable ... ok
test_204_delete_competitor (__main__.TestViralLensSystem.test_204_delete_competitor)
Test: Can delete competitor ... ok
test_205_competitor_enabled_field (__main__.TestViralLensSystem.test_205_competitor_enabled_field)
Test: Competitor enabled field is saved correctly ... ok
test_301_user_can_only_see_own_keywords (__main__.TestViralLensSystem.test_301_user_can_only_see_own_keywords)
Test: User 1 cannot see User 2's keywords ... ok
test_302_user_can_only_see_own_competitors (__main__.TestViralLensSystem.test_302_user_can_only_see_own_competitors)
Test: User 1 cannot see User 2's competitors ... ok
test_303_user_cannot_delete_others_keywords (__main__.TestViralLensSystem.test_303_user_cannot_delete_others_keywords)
Test: User 1 cannot delete User 2's keywords ... ok
test_304_user_cannot_toggle_others_competitors (__main__.TestViralLensSystem.test_304_user_cannot_toggle_others_competitors)
Test: User 1 cannot toggle User 2's competitors ... ok
test_401_add_keyword_without_category (__main__.TestViralLensSystem.test_401_add_keyword_without_category)
Test: Adding keyword without category defaults to 'primary' ... ok
test_402_empty_keyword_rejected (__main__.TestViralLensSystem.test_402_empty_keyword_rejected)
Test: Cannot add empty keyword ... ok
test_403_very_long_keyword (__main__.TestViralLensSystem.test_403_very_long_keyword)
Test: Very long keywords are handled ... ok
test_404_special_characters_in_keyword (__main__.TestViralLensSystem.test_404_special_characters_in_keyword)
Test: Special characters in keywords work ... ok

======================================================================
FAIL: test_003_signup_with_duplicate_email (__main__.TestViralLensSystem.test_003_signup_with_duplicate_email)
Test: Cannot sign up with duplicate email
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/jahanzeb/Desktop/Code/royal-research-automation/test_comprehensive.py", line 107, in test_003_signup_with_duplicate_email
    self.assertIn(b'email already registered', response.content.lower())
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: b'email already registered' not found in b'<!doctype html>\n<html lang="en">\n\n<head>\n    <meta charset="utf-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>dashboard - virallens</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        :root {\n            --primary: #6366f1;\n            --primary-dark: #4f46e5;\n            --secondary: #8b5cf6;\n            --success: #10b981;\n            --danger: #ef4444;\n            --warning: #f59e0b;\n            --dark: #1e293b;\n            --gray: #64748b;\n            --light: #f8fafc;\n            --white: #ffffff;\n        }\n\n        body {\n            font-family: -apple-system, blinkmacsystemfont, \'segoe ui\', roboto, oxygen, ubuntu, cantarell, sans-serif;\n            background: var(--light);\n            color: var(--dark);\n        }\n\n        /* navigation */\n        nav {\n            background: var(--white);\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n            padding: 1rem 0;\n            position: sticky;\n            top: 0;\n            z-index: 100;\n        }\n\n        nav .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            padding: 0 2rem;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n\n        .logo {\n            font-size: 1.5rem;\n            font-weight: 700;\n            color: var(--primary);\n            text-decoration: none;\n            display: flex;\n            align-items: center;\n            gap: 0.5rem;\n        }\n\n        .nav-right {\n            display: flex;\n            align-items: center;\n            gap: 2rem;\n        }\n\n        .user-info {\n            display: flex;\n            align-items: center;\n            gap: 1rem;\n        }\n\n        .user-avatar {\n            width: 40px;\n            height: 40px;\n            border-radius: 50%;\n            background: linear-gradient(135deg, var(--primary), var(--secondary));\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            color: white;\n            font-weight: 600;\n            font-size: 1.1rem;\n        }\n\n        .user-details {\n            display: flex;\n            flex-direction: column;\n        }\n\n        .user-name {\n            font-weight: 600;\n            color: var(--dark);\n            font-size: 0.9rem;\n        }\n\n        .user-tier {\n            font-size: 0.75rem;\n            color: var(--gray);\n            text-transform: capitalize;\n        }\n\n        .btn {\n            padding: 0.75rem 1.5rem;\n            border-radius: 0.5rem;\n            text-decoration: none;\n            font-weight: 600;\n            transition: all 0.3s;\n            display: inline-block;\n            border: none;\n            cursor: pointer;\n            font-size: 0.9rem;\n        }\n\n        .btn-primary {\n            background: var(--primary);\n            color: var(--white);\n        }\n\n        .btn-primary:hover {\n            background: var(--primary-dark);\n            transform: translatey(-2px);\n            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);\n        }\n\n        .btn-danger {\n            background: var(--danger);\n            color: var(--white);\n        }\n\n        .btn-danger:hover {\n            background: #dc2626;\n        }\n\n        .btn-outline {\n            background: transparent;\n            color: var(--gray);\n            border: 2px solid #e2e8f0;\n        }\n\n        .btn-outline:hover {\n            border-color: var(--primary);\n            color: var(--primary);\n        }\n\n        /* main container */\n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            padding: 2rem;\n        }\n\n        /* header */\n        .page-header {\n            margin-bottom: 2rem;\n        }\n\n        .page-header h1 {\n            font-size: 2rem;\n            margin-bottom: 0.5rem;\n            color: var(--dark);\n        }\n\n        .page-header p {\n            color: var(--gray);\n        }\n\n        /* stats grid */\n        .stats-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n            gap: 1.5rem;\n            margin-bottom: 2rem;\n        }\n\n        .stat-card {\n            background: var(--white);\n            padding: 1.5rem;\n            border-radius: 1rem;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n            transition: transform 0.3s, box-shadow 0.3s;\n        }\n\n        .stat-card:hover {\n            transform: translatey(-5px);\n            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);\n        }\n\n        .stat-label {\n            font-size: 0.875rem;\n            color: var(--gray);\n            margin-bottom: 0.5rem;\n            display: flex;\n            align-items: center;\n            gap: 0.5rem;\n        }\n\n        .stat-value {\n            font-size: 2rem;\n            font-weight: 700;\n            color: var(--dark);\n        }\n\n        .stat-badge {\n            display: inline-block;\n            padding: 0.25rem 0.75rem;\n            border-radius: 1rem;\n            font-size: 0.75rem;\n            font-weight: 600;\n            margin-top: 0.5rem;\n        }\n\n        .badge-success {\n            background: #d1fae5;\n            color: #065f46;\n        }\n\n        .badge-warning {\n            background: #fef3c7;\n            color: #92400e;\n        }\n\n        .badge-danger {\n            background: #fee2e2;\n            color: #991b1b;\n        }\n\n        /* action section */\n        .action-section {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            padding: 3rem;\n            border-radius: 1rem;\n            text-align: center;\n            color: white;\n            margin-bottom: 2rem;\n        }\n\n        .action-section h2 {\n            font-size: 1.75rem;\n            margin-bottom: 1rem;\n        }\n\n        .action-section p {\n            opacity: 0.9;\n            margin-bottom: 2rem;\n        }\n\n        .btn-white {\n            background: white;\n            color: var(--primary);\n            font-size: 1.1rem;\n            padding: 1rem 2rem;\n        }\n\n        .btn-white:hover {\n            transform: translatey(-2px);\n            box-shadow: 0 8px 20px rgba(255, 255, 255, 0.3);\n        }\n\n        /* research history */\n        .research-history {\n            background: var(--white);\n            padding: 2rem;\n            border-radius: 1rem;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n\n        .section-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 1.5rem;\n        }\n\n        .section-header h3 {\n            font-size: 1.25rem;\n            color: var(--dark);\n        }\n\n        .research-list {\n            display: flex;\n            flex-direction: column;\n            gap: 1rem;\n        }\n\n        .research-item {\n            padding: 1.5rem;\n            border: 2px solid #f1f5f9;\n            border-radius: 0.75rem;\n            transition: border-color 0.3s, transform 0.3s;\n        }\n\n        .research-item:hover {\n            border-color: var(--primary);\n            transform: translatex(5px);\n        }\n\n        .research-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: start;\n            margin-bottom: 1rem;\n        }\n\n        .research-meta {\n            display: flex;\n            gap: 1.5rem;\n            flex-wrap: wrap;\n            font-size: 0.875rem;\n            color: var(--gray);\n        }\n\n        .meta-item {\n            display: flex;\n            align-items: center;\n            gap: 0.5rem;\n        }\n\n        .research-keywords {\n            display: flex;\n            gap: 0.5rem;\n            flex-wrap: wrap;\n            margin-top: 0.5rem;\n        }\n\n        .keyword-tag {\n            background: #f1f5f9;\n            padding: 0.25rem 0.75rem;\n            border-radius: 0.5rem;\n            font-size: 0.75rem;\n            color: var(--gray);\n        }\n\n        .empty-state {\n            text-align: center;\n            padding: 3rem;\n            color: var(--gray);\n        }\n\n        .empty-state-icon {\n            font-size: 3rem;\n            margin-bottom: 1rem;\n            opacity: 0.5;\n        }\n\n        /* toast notifications */\n        .toast-container {\n            position: fixed;\n            top: 2rem;\n            right: 2rem;\n            z-index: 1000;\n            display: flex;\n            flex-direction: column;\n            gap: 1rem;\n        }\n\n        .toast {\n            background: white;\n            padding: 1rem 1.5rem;\n            border-radius: 0.75rem;\n            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n            display: flex;\n            align-items: center;\n            gap: 1rem;\n            min-width: 300px;\n            animation: slidein 0.3s ease-out;\n        }\n\n        @keyframes slidein {\n            from {\n                transform: translatex(400px);\n                opacity: 0;\n            }\n\n            to {\n                transform: translatex(0);\n                opacity: 1;\n            }\n        }\n\n        .toast-icon {\n            font-size: 1.5rem;\n        }\n\n        .toast-content {\n            flex: 1;\n        }\n\n        .toast-title {\n            font-weight: 600;\n            margin-bottom: 0.25rem;\n        }\n\n        .toast-message {\n            font-size: 0.875rem;\n            color: var(--gray);\n        }\n\n        .toast-close {\n            cursor: pointer;\n            opacity: 0.5;\n            transition: opacity 0.3s;\n        }\n\n        .toast-close:hover {\n            opacity: 1;\n        }\n\n        .toast-success {\n            border-left: 4px solid var(--success);\n        }\n\n        .toast-error {\n            border-left: 4px solid var(--danger);\n        }\n\n        .toast-warning {\n            border-left: 4px solid var(--warning);\n        }\n\n        .toast-info {\n            border-left: 4px solid var(--primary);\n        }\n\n        /* loading spinner */\n        .loading {\n            display: inline-block;\n            width: 20px;\n            height: 20px;\n            border: 3px solid rgba(255, 255, 255, 0.3);\n            border-radius: 50%;\n            border-top-color: white;\n            animation: spin 1s ease-in-out infinite;\n        }\n\n        @keyframes spin {\n            to {\n                transform: rotate(360deg);\n            }\n        }\n\n        /* responsive */\n        @media (max-width: 768px) {\n            .nav-right {\n                gap: 1rem;\n            }\n\n            .user-details {\n                display: none;\n            }\n\n            .stats-grid {\n                grid-template-columns: 1fr;\n            }\n\n            .toast-container {\n                top: 1rem;\n                right: 1rem;\n                left: 1rem;\n            }\n\n            .toast {\n                min-width: unset;\n            }\n        }\n    </style>\n</head>\n\n<body>\n    <!-- toast container -->\n    <div class="toast-container" id="toastcontainer"></div>\n\n    <!-- navigation -->\n    <nav>\n        <div class="container">\n            <a href="/dashboard" class="logo">\n                \xf0\x9f\x8e\xaf virallens\n            </a>\n            <div class="nav-right">\n                <div class="user-info">\n                    <div class="user-avatar">\n                        u\n                    </div>\n                    <div class="user-details">\n                        <div class="user-name">user one</div>\n                        <div class="user-tier">free plan</div>\n                    </div>\n                </div>\n                <a href="/settings" class="btn btn-outline">settings</a>\n                <a href="/logout" class="btn btn-danger">logout</a>\n            </div>\n        </div>\n    </nav>\n\n    <!-- main content -->\n    <div class="container">\n        <!-- page header -->\n        <div class="page-header">\n            <h1>welcome back, user one! \xf0\x9f\x91\x8b</h1>\n            <p>your viral content research dashboard</p>\n        </div>\n\n        <!-- stats grid -->\n        <div class="stats-grid">\n            <div class="stat-card">\n                <div class="stat-label">\n                    \xf0\x9f\x93\x8a research runs this month\n                </div>\n                <div class="stat-value">0</div>\n                <div class="stat-badge badge-success">\n                    5 remaining\n                </div>\n            </div>\n\n            <div class="stat-card">\n                <div class="stat-label">\n                    \xf0\x9f\x8e\xaf total research runs\n                </div>\n                <div class="stat-value">0</div>\n                <div class="stat-badge badge-success">\n                    all time\n                </div>\n            </div>\n\n            <div class="stat-card">\n                <div class="stat-label">\n                    \xf0\x9f\x92\x8e subscription tier\n                </div>\n                <div class="stat-value" style="font-size: 1.5rem; text-transform: capitalize;">\n                    free\n                </div>\n                <div class="stat-badge badge-success">\n                    active\n                </div>\n            </div>\n\n            <div class="stat-card">\n                <div class="stat-label">\n                    \xf0\x9f\x93\x85 member since\n                </div>\n                <div class="stat-value" style="font-size: 1.2rem;">\n                    jan 2026\n                </div>\n                <div class="stat-badge badge-success">\n                    active\n                </div>\n            </div>\n        </div>\n\n        <!-- action section -->\n        <div class="action-section">\n            <h2>ready to generate viral content ideas?</h2>\n            <p>analyze 5 data sources in 30 seconds to get ai-powered topic recommendations</p>\n            <div id="initialstate">\n                <button class="btn btn-white" onclick="runresearch()">\n                    <span>\xf0\x9f\x9a\x80 run research now</span>\n                </button>\n            </div>\n\n            <div id="progressstate" style="display: none; max-width: 600px; margin: 0 auto;">\n                <h3 style="margin-bottom: 1rem; font-size: 1.25rem;">analyzing data sources...</h3>\n\n                <!-- progress bar -->\n                <div\n                    style="background: rgba(255,255,255,0.2); border-radius: 1rem; height: 12px; margin-bottom: 2rem; overflow: hidden; position: relative;">\n                    <div id="progressbar"\n                        style="width: 0%; height: 100%; background: #ffffff; border-radius: 1rem; transition: width 0.5s ease;">\n                    </div>\n                </div>\n\n                <!-- source icons grid -->\n                <div style="display: flex; justify-content: center; gap: 2rem; flex-wrap: wrap;">\n                    <div class="source-item" id="source-trends">\n                        <div class="source-icon">\xf0\x9f\x93\x88</div>\n                        <div class="source-label">trends</div>\n                        <div class="source-status">waiting</div>\n                    </div>\n                    <div class="source-item" id="source-youtube">\n                        <div class="source-icon">\xe2\x96\xb6\xef\xb8\x8f</div>\n                        <div class="source-label">youtube</div>\n                        <div class="source-status">waiting</div>\n                    </div>\n                    <div class="source-item" id="source-reddit">\n                        <div class="source-icon">\xf0\x9f\xa4\x96</div>\n                        <div class="source-label">reddit</div>\n                        <div class="source-status">waiting</div>\n                    </div>\n                    <div class="source-item" id="source-news">\n                        <div class="source-icon">\xf0\x9f\x93\xb0</div>\n                        <div class="source-label">news</div>\n                        <div class="source-status">waiting</div>\n                    </div>\n                    <div class="source-item" id="source-cp">\n                        <div class="source-icon">\xf0\x9f\xa7\xa0</div>\n                        <div class="source-label">analysis</div>\n                        <div class="source-status">waiting</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <style>\n            .source-item {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                gap: 0.5rem;\n                opacity: 0.5;\n                transition: all 0.3s ease;\n            }\n\n            .source-item.active {\n                opacity: 1;\n                transform: scale(1.1);\n            }\n\n            .source-item.done {\n                opacity: 1;\n                color: #a7f3d0;\n            }\n\n            .source-icon {\n                font-size: 2rem;\n                background: rgba(255, 255, 255, 0.1);\n                width: 60px;\n                height: 60px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                border-radius: 50%;\n                margin-bottom: 0.25rem;\n            }\n\n            .source-label {\n                font-size: 0.875rem;\n                font-weight: 600;\n            }\n\n            .source-status {\n                font-size: 0.75rem;\n                opacity: 0.8;\n            }\n\n            @keyframes pulse {\n                0% {\n                    box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4);\n                }\n\n                70% {\n                    box-shadow: 0 0 0 10px rgba(255, 255, 255, 0);\n                }\n\n                100% {\n                    box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);\n                }\n            }\n\n            .source-item.active .source-icon {\n                animation: pulse 1.5s infinite;\n                background: rgba(255, 255, 255, 0.25);\n            }\n        </style>\n\n        <!-- research history -->\n        <div class="research-history">\n            <div class="section-header">\n                <h3>recent research runs</h3>\n                <span style="color: var(--gray); font-size: 0.875rem;">\n                    0 total\n                </span>\n            </div>\n\n            \n            <div class="empty-state">\n                <div class="empty-state-icon">\xf0\x9f\x94\x8d</div>\n                <h3>no research runs yet</h3>\n                <p>click "run research now" to generate your first viral content ideas!</p>\n            </div>\n            \n        </div>\n    </div>\n\n    <script>\n        // toast notification system\n        function showtoast(type, title, message, duration = 5000) {\n            const container = document.getelementbyid(\'toastcontainer\');\n            const toast = document.createelement(\'div\');\n            toast.classname = `toast toast-${type}`;\n\n            const icons = {\n                success: \'\xe2\x9c\x85\',\n                error: \'\xe2\x9d\x8c\',\n                warning: \'\xe2\x9a\xa0\xef\xb8\x8f\',\n                info: \'\xe2\x84\xb9\xef\xb8\x8f\'\n            };\n\n            toast.innerhtml = `\n                <div class="toast-icon">${icons[type]}</div>\n                <div class="toast-content">\n                    <div class="toast-title">${title}</div>\n                    <div class="toast-message">${message}</div>\n                </div>\n                <div class="toast-close" onclick="this.parentelement.remove()">\xe2\x9c\x95</div>\n            `;\n\n            container.appendchild(toast);\n\n            settimeout(() => {\n                toast.style.animation = \'slidein 0.3s ease-out reverse\';\n                settimeout(() => toast.remove(), 300);\n            }, duration);\n        }\n\n        // show flash messages as toasts\n        \n        \n        \n        showtoast(\'success\', \'success\', \'welcome, user1_176880100768168! your account has been created.\');\n        \n        \n        \n\n        // run research\n        // run research\n        async function runresearch() {\n            // check limits first\n            \n\n            // 1. switch ui\n            document.getelementbyid(\'initialstate\').style.display = \'none\';\n            document.getelementbyid(\'progressstate\').style.display = \'block\';\n\n            const progressbar = document.getelementbyid(\'progressbar\');\n            const sources = [\n                { id: \'source-trends\', time: 1000 },\n                { id: \'source-youtube\', time: 3000 },\n                { id: \'source-news\', time: 5000 },\n                { id: \'source-reddit\', time: 8000 },\n                { id: \'source-cp\', time: 11000 }\n            ];\n\n            // 2. start simulation animation (approx 15s total)\n            let progress = 0;\n            const interval = setinterval(() => {\n                if (progress < 90) {\n                    progress += 1; // slow increment\n                    progressbar.style.width = `${progress}%`;\n                }\n            }, 150); // updates every 150ms -> reaches 90% in ~13.5s\n\n            // animate sources sequentially\n            sources.foreach(src => {\n                settimeout(() => {\n                    const el = document.getelementbyid(src.id);\n                    el.classlist.add(\'active\');\n                    el.queryselector(\'.source-status\').innertext = \'scanning...\';\n                }, src.time);\n\n                settimeout(() => {\n                    const el = document.getelementbyid(src.id);\n                    el.classlist.remove(\'active\');\n                    el.classlist.add(\'done\');\n                    el.queryselector(\'.source-status\').innertext = \'complete\';\n                }, src.time + 2500); // 2.5s scan time per source\n            });\n\n            // 3. make the api call\n            try {\n                const response = await fetch(\'/api/run-research\', {\n                    method: \'post\',\n                    headers: { \'content-type\': \'application/json\' }\n                });\n\n                const data = await response.json();\n\n                if (data.success) {\n                    // success!\n                    clearinterval(interval);\n                    progressbar.style.width = \'100%\';\n                    progressbar.style.backgroundcolor = \'#10b981\'; // green\n\n                    showtoast(\'success\', \'research complete!\', `generated ${data.topics.length} viral topic ideas`);\n\n                    // wait a moment for user to see 100%\n                    settimeout(() => location.reload(), 1500);\n                } else {\n                    handleerror(data.error);\n                }\n            } catch (error) {\n                handleerror(error.message);\n            }\n\n            function handleerror(msg) {\n                clearinterval(interval);\n                progressbar.style.backgroundcolor = \'#ef4444\'; // red\n                showtoast(\'error\', \'research failed\', msg || \'something went wrong\');\n\n                // reset ui after delay\n                settimeout(() => {\n                    document.getelementbyid(\'progressstate\').style.display = \'none\';\n                    document.getelementbyid(\'initialstate\').style.display = \'block\';\n                    // reset bars/icons? or just reload logic handles it. \n                    // simpler to just show the button again.\n                }, 4000);\n            }\n        }\n    </script>\n</body>\n\n</html>'

----------------------------------------------------------------------
Ran 26 tests in 2.113s

FAILED (failures=1)

[94m[1m======================================================================
  VIRALENS AUTOMATED TEST SUITE
======================================================================[0m

Testing against: http://127.0.0.1:8000
Started at: 2026-01-19 10:36:47

[92m‚úÖ Server is running[0m

[92m‚úÖ Landing page accessible[0m
[92m‚úÖ Signup successful[0m
[92m‚úÖ Login successful[0m
[92m‚úÖ Invalid credentials rejected[0m
[92m‚úÖ Protected routes require login[0m
[92m‚úÖ Logout clears session[0m
[92m‚úÖ Keyword added successfully[0m
[92m‚úÖ Keywords retrieved successfully[0m
[92m‚úÖ Keyword edited successfully[0m
[92m‚úÖ Keyword toggled successfully[0m
[92m‚úÖ Keyword deleted successfully[0m
[92m‚úÖ Keyword categories saved correctly[0m
[92m‚úÖ Competitor added successfully[0m
[92m‚úÖ Competitors retrieved successfully[0m
[92m‚úÖ Competitor toggled successfully[0m
[92m‚úÖ Competitor deleted successfully[0m
[92m‚úÖ Competitor enabled field correct[0m
[92m‚úÖ Keyword isolation verified[0m
[92m‚úÖ Competitor isolation verified[0m
[92m‚úÖ Cross-user deletion blocked[0m
[92m‚úÖ Cross-user toggle blocked[0m
[92m‚úÖ Default category works[0m
[92m‚úÖ Empty keyword rejected[0m
[92m‚úÖ Long keyword handled[0m
[92m‚úÖ Special characters handled[0m

[94m[1m======================================================================
  TEST SUMMARY
======================================================================[0m

Total Tests:  26
[92mPassed:       25[0m
[91mFailed:       1[0m

Success Rate: 96.2%

[91m‚ö†Ô∏è  Some tests failed. Review output above.[0m

