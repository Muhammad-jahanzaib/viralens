{% extends "base.html" %}

{% block title %}Admin Panel - VIRALENS{% endblock %}

{% block extra_css %}
<style>
    /* Admin Common Styles */
    .admin-dashboard {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
    }

    /* Header & Navigation */
    .admin-header {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        color: white;
        padding: 30px;
        border-radius: 12px;
        margin-bottom: 30px;
    }

    .admin-header h1 {
        margin: 0 0 20px 0;
        font-size: 32px;
        font-weight: 700;
    }

    .admin-nav {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
    }

    .admin-nav a {
        color: white;
        text-decoration: none;
        padding: 10px 20px;
        border-radius: 6px;
        background: rgba(255, 255, 255, 0.1);
        transition: all 0.3s;
        font-size: 14px;
        font-weight: 500;
    }

    .admin-nav a:hover,
    .admin-nav a.active {
        background: rgba(255, 255, 255, 0.25);
        transform: translateY(-1px);
    }

    .admin-nav .btn-back {
        margin-left: auto;
        background: rgba(255, 255, 255, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .admin-nav .btn-back:hover {
        background: rgba(255, 255, 255, 0.25);
    }

    /* Cards & Containers */
    .section-card {
        background: white;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
        margin-bottom: 25px;
        border: 1px solid #f1f5f9;
    }

    .section-card h2 {
        margin: 0 0 20px 0;
        color: #1e293b;
        font-size: 20px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .admin-content-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
        gap: 25px;
        margin-bottom: 25px;
    }

    /* Stats Grid */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .stat-card {
        background: white;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        display: flex;
        align-items: center;
        gap: 20px;
        border: 1px solid #f1f5f9;
        transition: transform 0.2s;
    }

    .stat-card:hover {
        transform: translateY(-2px);
    }

    .stat-icon {
        font-size: 40px;
        background: #f5f3ff;
        width: 70px;
        height: 70px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 12px;
    }

    .stat-content {
        flex: 1;
    }

    .stat-value {
        font-size: 32px;
        font-weight: 700;
        color: #6366f1;
        line-height: 1.2;
    }

    .stat-label {
        color: #64748b;
        font-size: 14px;
        margin-bottom: 4px;
        font-weight: 500;
    }

    .stat-detail {
        color: #94a3b8;
        font-size: 13px;
    }

    /* Tables */
    .table-responsive {
        overflow-x: auto;
        border-radius: 8px;
        border: 1px solid #e2e8f0;
    }

    .admin-table {
        width: 100%;
        border-collapse: collapse;
        white-space: nowrap;
    }

    .admin-table th {
        background: #f8fafc;
        padding: 14px 16px;
        text-align: left;
        font-weight: 600;
        color: #475569;
        font-size: 13px;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        border-bottom: 1px solid #e2e8f0;
    }

    .admin-table td {
        padding: 14px 16px;
        border-bottom: 1px solid #e2e8f0;
        font-size: 14px;
        color: #334155;
    }

    .admin-table tr:hover {
        background: #f8fafc;
    }

    .table-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    /* Badges & Status */
    .badge {
        display: inline-flex;
        align-items: center;
        padding: 3px 10px;
        border-radius: 9999px;
        font-size: 12px;
        font-weight: 600;
        line-height: 1.5;
    }

    .badge-admin {
        background: #fbbf24;
        color: #92400e;
    }

    .badge-free {
        background: #e2e8f0;
        color: #475569;
    }

    .badge-pro {
        background: #ddd6fe;
        color: #5b21b6;
    }

    .badge-agency {
        background: #a7f3d0;
        color: #065f46;
    }

    .status-active {
        color: #10b981;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 4px;
    }

    .status-inactive {
        color: #ef4444;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 4px;
    }

    .action-badge {
        background: #f1f5f9;
        padding: 4px 10px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
        color: #475569;
        font-family: monospace;
    }

    /* Buttons */
    .btn-sm {
        padding: 6px 12px;
        background: #6366f1;
        color: white;
        text-decoration: none;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 500;
        transition: all 0.2s;
    }

    .btn-sm:hover {
        background: #4f46e5;
    }

    .btn-action {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 12px 20px;
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        color: white;
        text-decoration: none;
        border-radius: 8px;
        font-weight: 600;
        transition: all 0.3s;
        border: none;
        cursor: pointer;
        gap: 8px;
    }

    .btn-action:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
        color: white;
    }

    .btn-link {
        color: #6366f1;
        text-decoration: none;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        margin-top: 15px;
        font-size: 14px;
        transition: color 0.2s;
    }

    .btn-link:hover {
        color: #4f46e5;
        text-decoration: underline;
    }

    .btn-warning {
        padding: 10px 20px;
        background: #f59e0b;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        transition: background 0.2s;
    }

    .btn-warning:hover {
        background: #d97706;
    }

    /* Forms */
    .form-group {
        margin-bottom: 20px;
    }

    .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #475569;
        font-size: 14px;
    }

    .form-group input[type="text"],
    .form-group input[type="email"],
    .form-group input[type="password"],
    .form-group input[type="number"],
    .form-group select {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #cbd5e1;
        border-radius: 6px;
        font-size: 14px;
        transition: border-color 0.2s, box-shadow 0.2s;
    }

    .form-group input:focus,
    .form-group select:focus {
        outline: none;
        border-color: #6366f1;
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .form-group input[type="checkbox"] {
        margin-right: 8px;
        transform: scale(1.1);
    }

    /* Pagination */
    .pagination {
        display: flex;
        justify-content: center;
        gap: 5px;
        margin-top: 25px;
    }

    .page-link {
        padding: 8px 14px;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 6px;
        color: #475569;
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s;
    }

    .page-link:hover {
        background: #f8fafc;
        border-color: #cbd5e1;
    }

    .page-link.active {
        background: #6366f1;
        color: white;
        border-color: #6366f1;
    }

    /* Utilities */
    .no-data {
        text-align: center;
        color: #94a3b8;
        padding: 40px;
        font-style: italic;
        background: #f8fafc;
        border-radius: 8px;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .admin-nav {
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .admin-nav a {
            white-space: nowrap;
        }

        .admin-content-grid {
            grid-template-columns: 1fr;
        }

        .stats-grid {
            grid-template-columns: 1fr;
        }

        .admin-header h1 {
            font-size: 24px;
        }

        .admin-header {
            padding: 20px;
        }
    }
</style>
{% block admin_extra_css %}{% endblock %}
{% endblock %}

{% block content %}
<div class="admin-dashboard">
    <!-- Common Admin Header -->
    <div class="admin-header">
        <h1>{% block header_title %}üõ°Ô∏è Admin Dashboard{% endblock %}</h1>
        <div class="admin-nav">
            <a href="{{ url_for('admin.dashboard') }}"
                class="nav-link {{ 'active' if request.endpoint == 'admin.dashboard' }}">
                Dashboard
            </a>
            <a href="{{ url_for('admin.users') }}" class="nav-link {{ 'active' if 'users' in request.endpoint }}">
                Users
            </a>
            <a href="{{ url_for('admin.users_pending') }}"
                class="nav-link {{ 'active' if 'users_pending' in request.endpoint }}">
                ‚è≥ Pending Approvals
                {% if pending_count > 0 %}
                <span class="badge">{{ pending_count }}</span>
                {% endif %}
            </a>
            <a href="{{ url_for('admin.research_runs') }}"
                class="nav-link {{ 'active' if 'research' in request.endpoint }}">
                Research Runs
            </a>
            <a href="{{ url_for('admin.analytics') }}"
                class="nav-link {{ 'active' if 'analytics' in request.endpoint }}">
                Analytics
            </a>
            <a href="{{ url_for('admin.logs') }}" class="nav-link {{ 'active' if 'logs' in request.endpoint }}">
                Audit Logs
            </a>
            <a href="{{ url_for('admin.settings') }}" class="nav-link {{ 'active' if 'settings' in request.endpoint }}">
                Settings
            </a>
            <a href="{{ url_for('logout') }}" class="nav-link">
                Logout
            </a>
            <a href="{{ url_for('dashboard') }}" class="nav-link btn-back">
                ‚Üê Back to App
            </a>
        </div>
    </div>

    <!-- Page Specific Content -->
    {% block admin_content %}{% endblock %}
</div>
{% endblock %}

{% block scripts %}
<script>
    // Common Admin JS can go here
    document.addEventListener('DOMContentLoaded', function () {
        // Auto-dismiss flashes is already in base.html
    });
</script>
{% block admin_scripts %}{% endblock %}
{% endblock %}